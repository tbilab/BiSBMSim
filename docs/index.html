<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulate Data From Bipartite Stochastic Block Model • bisbmsim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Simulate Data From Bipartite Stochastic Block Model">
<meta property="og:description" content="Series of functions to generate data from bipartite stochastic block model with various assumptions.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bisbmsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="bisbmsim" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bisbmsim" class="anchor"></a>BiSbmSim</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>This package simulates data using the bipartite stochastic block model (BiSbm).</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the unrelased version of bisbmsim from github with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">'tbilab/bisbmsim'</span>)</a></code></pre></div>
<p>If you want to install a non-changing version of this package, pin to the latest release.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">'tbilab/BiSBMSim'</span>, <span class="dt">ref =</span> <span class="st">'v0.10'</span>)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bisbmsim)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(purrr)</a></code></pre></div>
</div>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<p>Super simple simulation.</p>
<p>First we need to setup basic parameters corresponding to model</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">N_a &lt;-<span class="st"> </span><span class="dv">125</span>  <span class="co"># Number of nodes of the a type</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">N_b &lt;-<span class="st"> </span><span class="dv">105</span>  <span class="co"># Number of nodes of the b type</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">K_a &lt;-<span class="st"> </span><span class="dv">4</span>    <span class="co"># How many blocks of a type nodes are there</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">K_b &lt;-<span class="st"> </span><span class="dv">3</span>    <span class="co"># How many blocks of the b type nodes are there</span></a></code></pre></div>
<div id="inputs-needed" class="section level2">
<h2 class="hasAnchor">
<a href="#inputs-needed" class="anchor"></a>Inputs Needed</h2>
<p>The Stochastic Block Model is defined by two main inputs.</p>
<div id="group-membership-vectors" class="section level3">
<h3 class="hasAnchor">
<a href="#group-membership-vectors" class="anchor"></a>Group Membership Vectors</h3>
<p>The group membership vectors are vectors of length <code>N_a</code> for a-nodes and <code>N_b</code> for b-nodes. Each element in these vectors is the integer ID of the group that node belongs to.</p>
<p><code>assign_group_membership</code> is a function that will build these membership vectors for you when supplied with size and group numbers. By default they evenly space the groups across the nodes but by using the option <code>place_randomly = TRUE</code> you can also stochastically assign group membership.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">b_a &lt;-<span class="st"> </span><span class="kw"><a href="reference/assign_group_membership.html">assign_group_membership</a></span>(<span class="dt">N =</span> N_a, <span class="dt">K =</span> K_a) <span class="co"># Block membership for each a node</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">b_b &lt;-<span class="st"> </span><span class="kw"><a href="reference/assign_group_membership.html">assign_group_membership</a></span>(<span class="dt">N =</span> N_b, <span class="dt">K =</span> K_b) <span class="co"># Block membership for each b node</span></a></code></pre></div>
</div>
<div id="the-lambda-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#the-lambda-matrix" class="anchor"></a>The Lambda matrix</h3>
<p>The Lambda matrix (or tidy dataframe in this case) tells the model the <em>average number of connections between each pair of a and b groups</em>. In the case of the standard Poisson SBM this means that if the model is determining the number of edges between a node in group <code>i</code> and a node in group <code>j</code>, it does so by drawing from a Poisson distribution with the mean (or lambda) value of <code>Lambda(i,j)</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">Lambda &lt;-<span class="st"> </span><span class="kw"><a href="reference/generate_random_lambda.html">generate_random_lambda</a></span>(<span class="dt">K_a =</span> K_a, <span class="dt">K_b =</span> K_b)</a></code></pre></div>
<p>Here’s what this Lambda looks like.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggplot</span>(Lambda, <span class="kw">aes</span>(<span class="dt">x =</span> a, <span class="dt">y =</span> b)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_tile</span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">    <span class="kw">aes</span>(<span class="dt">fill =</span> avg_num_cons),</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    <span class="dt">color =</span> <span class="st">'white'</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">"white"</span>, <span class="dt">high =</span> <span class="st">"#56B1F7"</span>)</a></code></pre></div>
<p><img src="reference/figures/README-visualizing_lambda-1.png" width="100%"></p>
<p>The <code><a href="reference/generate_random_lambda.html">generate_random_lambda()</a></code> function by default builds a lambda between <code>K_a</code> a-type groups and <code>K_b</code> b-type groups by drawing from a random uniform distribution. You can change the model that generates the values by passing the <code>random_generator</code> option a function that takes an input <code>n</code> and returns <code>n</code> values.</p>
<p>For instance, here’s a Lambda where the individual values are drawn from a beta distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">drawn_n_betas &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span>(n, <span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="reference/generate_random_lambda.html">generate_random_lambda</a></span>(<span class="dt">K_a =</span> K_a, <span class="dt">K_b =</span> K_b, <span class="dt">random_generator =</span> drawn_n_betas)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;    a b avg_num_cons</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 1  1 1   0.74878219</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 2  2 1   0.03877181</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 3  3 1   0.69267063</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; 4  4 1   0.60364815</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 5  1 2   0.31644165</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 6  2 2   0.55183415</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; 7  3 2   0.61135893</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; 8  4 2   0.16986558</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; 9  1 3   0.23948770</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; 10 2 3   0.46559814</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; 11 3 3   0.90508306</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; 12 4 3   0.58878403</span></a></code></pre></div>
</div>
</div>
<div id="drawing-simulated-data-from-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-simulated-data-from-a-model" class="anchor"></a>Drawing simulated data from a model</h2>
<p>Now that we have defined the two main inputs needed for determining an SBM, the group membership vectors and the Lambda matrix, we can proceed to actually drawing from the SBM model.</p>
<p><em>Note that we have provided names for the different node types with the <code>a_name</code> and <code>b_name</code> arguments.</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">all_node_pairs &lt;-<span class="st"> </span><span class="kw"><a href="reference/draw_from_model.html">draw_from_model</a></span>(b_a, b_b, Lambda, <span class="dt">a_name =</span> <span class="st">"Subjects"</span>, <span class="dt">b_name =</span> <span class="st">"Phecodes"</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">all_node_pairs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; # A tibble: 6 x 6</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;   Subjects Phecodes a_group b_group avg_num_cons num_edges</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;      &lt;int&gt;    &lt;int&gt;   &lt;int&gt;   &lt;int&gt;        &lt;dbl&gt;     &lt;int&gt;</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; 1        1        1       1       1        0.393         0</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; 2        2        1       2       1        0.593         1</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; 3        3        1       3       1        0.877         1</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; 4        4        1       4       1        0.627         0</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; 5        5        1       1       1        0.393         1</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; 6        6        1       2       1        0.593         1</span></a></code></pre></div>
<p>We can compare this now with the true underlying generation parameters….</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">plot_sim_results &lt;-<span class="st"> </span><span class="cf">function</span>(drawn_node_pairs){</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  drawn_node_pairs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">'type'</span>, <span class="dt">value =</span> <span class="st">'connections'</span>, num_edges, avg_num_cons) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(type <span class="op">==</span><span class="st"> 'num_edges'</span>, <span class="st">"Drawn Values"</span>, <span class="st">"Lambda"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">    </span><span class="kw">arrange</span>(a_group, b_group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(Subjects, a_group), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(Phecodes, b_group))) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> connections), <span class="dt">color =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>type) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">"white"</span>, <span class="dt">high =</span> <span class="st">"#56B1F7"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">'Subjects'</span>, <span class="dt">x =</span> <span class="st">'Phecodes'</span>) </a>
<a class="sourceLine" id="cb10-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb10-14" data-line-number="14"></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="kw">plot_sim_results</span>(all_node_pairs)</a></code></pre></div>
<p><img src="reference/figures/README-simulation_results-1.png" width="100%"></p>
<div id="binary-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#binary-mode" class="anchor"></a>Binary Mode</h3>
<p>If only binary connected, not-connected results are desired, there is an option <code>binary_connections</code> in <code><a href="reference/draw_from_model.html">draw_from_model()</a></code> that uses the bernouli distribution to decide if each edge exists or not, rather than the standard Poisson.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="reference/draw_from_model.html">draw_from_model</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">b_a =</span> b_a, </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">b_b =</span> b_b, </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">Lambda =</span> Lambda, </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="dt">binary_connections =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">a_name =</span> <span class="st">"Subjects"</span>, </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="dt">b_name =</span> <span class="st">"Phecodes"</span> </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span><span class="kw">plot_sim_results</span>()</a></code></pre></div>
<p><img src="reference/figures/README-binary_simulation_results-1.png" width="100%"></p>
</div>
</div>
<div id="setting-up-planted-patterns" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-up-planted-patterns" class="anchor"></a>Setting up planted patterns</h2>
<p>If more control over the model setup is desired, the function <code>setup_planted_pattern_model</code> allows specification of a full model allowing you to specify patterns of b-nodes that characterize groups of a-nodes.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">my_patterns &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  <span class="op">~</span>b1,  <span class="op">~</span>b2,  <span class="op">~</span>b3,  <span class="op">~</span>b4,  <span class="op">~</span>size,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">    <span class="dv">1</span>,    <span class="dv">1</span>,    <span class="dv">0</span>,    <span class="dv">0</span>,     <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">    <span class="dv">1</span>,    <span class="dv">1</span>,    <span class="dv">1</span>,    <span class="dv">0</span>,     <span class="dv">15</span>,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">    <span class="dv">0</span>,    <span class="dv">0</span>,    <span class="dv">0</span>,    <span class="dv">1</span>,     <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    <span class="dv">0</span>,    <span class="dv">0</span>,    <span class="dv">1</span>,    <span class="dv">1</span>,     <span class="dv">24</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">planted_model_params &lt;-<span class="st"> </span><span class="kw"><a href="reference/setup_planted_pattern_model.html">setup_planted_pattern_model</a></span>(</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  my_patterns, </a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  <span class="dt">num_noise_nodes =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">  <span class="dt">noise_p =</span> <span class="fl">0.03</span>,</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">  <span class="dt">planted_p_on =</span> <span class="fl">0.95</span>,</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">  <span class="dt">planted_p_off =</span> <span class="fl">0.01</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">planted_model_params</a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; $b_a</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; [36] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; $b_b</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt;  [1] 1 2 3 4 5 5 5 5 5 5 5 5 5 5</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; $Lambda</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; # A tibble: 20 x 3</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt;        a     b avg_num_cons</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt;  1     1     1         0.95</span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt;  2     2     1         0.95</span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt;  3     3     1         0.01</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co">#&gt;  4     4     1         0.01</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="co">#&gt;  5     1     2         0.95</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="co">#&gt;  6     2     2         0.95</span></a>
<a class="sourceLine" id="cb12-34" data-line-number="34"><span class="co">#&gt;  7     3     2         0.01</span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35"><span class="co">#&gt;  8     4     2         0.01</span></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="co">#&gt;  9     1     3         0.01</span></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="co">#&gt; 10     2     3         0.95</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38"><span class="co">#&gt; 11     3     3         0.01</span></a>
<a class="sourceLine" id="cb12-39" data-line-number="39"><span class="co">#&gt; 12     4     3         0.95</span></a>
<a class="sourceLine" id="cb12-40" data-line-number="40"><span class="co">#&gt; 13     1     4         0.01</span></a>
<a class="sourceLine" id="cb12-41" data-line-number="41"><span class="co">#&gt; 14     2     4         0.01</span></a>
<a class="sourceLine" id="cb12-42" data-line-number="42"><span class="co">#&gt; 15     3     4         0.95</span></a>
<a class="sourceLine" id="cb12-43" data-line-number="43"><span class="co">#&gt; 16     4     4         0.95</span></a>
<a class="sourceLine" id="cb12-44" data-line-number="44"><span class="co">#&gt; 17     1     5         0.03</span></a>
<a class="sourceLine" id="cb12-45" data-line-number="45"><span class="co">#&gt; 18     2     5         0.03</span></a>
<a class="sourceLine" id="cb12-46" data-line-number="46"><span class="co">#&gt; 19     3     5         0.03</span></a>
<a class="sourceLine" id="cb12-47" data-line-number="47"><span class="co">#&gt; 20     4     5         0.03</span></a></code></pre></div>
<p>The function returns a list with the three needed inputs for <code><a href="reference/draw_from_model.html">draw_from_model()</a></code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">draw_from_planted &lt;-<span class="st"> </span>planted_model_params <span class="op">%$%</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/draw_from_model.html">draw_from_model</a></span>(</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    b_a, b_b, Lambda, </a>
<a class="sourceLine" id="cb13-4" data-line-number="4">    <span class="dt">binary_connections =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    <span class="dt">a_name =</span> <span class="st">"Subjects"</span>, </a>
<a class="sourceLine" id="cb13-6" data-line-number="6">    <span class="dt">b_name =</span> <span class="st">"Phecodes"</span> )</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw">plot_sim_results</span>(draw_from_planted)</a></code></pre></div>
<p><img src="reference/figures/README-planted_simulation_results-1.png" width="100%"></p>
</div>
<div id="running-lots-of-simulations" class="section level2">
<h2 class="hasAnchor">
<a href="#running-lots-of-simulations" class="anchor"></a>Running lots of simulations</h2>
<p>Once you have your SBM inputs setup all you need to do is loop for as many simulations as you want and call <code><a href="reference/draw_from_model.html">draw_from_model()</a></code> each time to get new draws.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">num_draws &lt;-<span class="st"> </span><span class="dv">36</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">all_draws &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>num_draws <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_dfr</a></span>(<span class="cf">function</span>(draw_num){</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    planted_model_params <span class="op">%$%</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="st">      </span><span class="kw"><a href="reference/draw_from_model.html">draw_from_model</a></span>(b_a, b_b, Lambda, <span class="dt">binary_connections =</span> <span class="ot">TRUE</span>, <span class="dt">a_name =</span> <span class="st">"Subjects"</span>, <span class="dt">b_name =</span> <span class="st">"Phecodes"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">draw =</span> draw_num)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  })</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">all_draws <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="st">  </span><span class="kw">arrange</span>(a_group, b_group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(Subjects, a_group), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(Phecodes, b_group))) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> num_edges), <span class="dt">color =</span> <span class="st">"white"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="st">    </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">"white"</span>, <span class="dt">high =</span> <span class="st">"#56B1F7"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">'Subjects'</span>, <span class="dt">x =</span> <span class="st">'Phecodes'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>draw) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="reference/figures/README-multiple_simulation_draws-1.png" width="100%"></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Nick Strayer <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Nick Strayer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
